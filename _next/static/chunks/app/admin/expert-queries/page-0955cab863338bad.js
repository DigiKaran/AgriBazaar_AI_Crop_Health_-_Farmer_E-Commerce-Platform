(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1446],{8376:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},26126:(e,s,t)=>{"use strict";t.d(s,{E:()=>d});var r=t(95155);t(12115);var i=t(74466),a=t(59434);let n=(0,i.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:s,variant:t,...i}=e;return(0,r.jsx)("div",{className:(0,a.cn)(n({variant:t}),s),...i})}},40968:(e,s,t)=>{"use strict";t.d(s,{b:()=>d});var r=t(12115),i=t(63655),a=t(95155),n=r.forwardRef((e,s)=>(0,a.jsx)(i.sG.label,{...e,ref:s,onMouseDown:s=>{var t;s.target.closest("button, input, select, textarea")||(null==(t=e.onMouseDown)||t.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));n.displayName="Label";var d=n},45554:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]])},59966:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]])},60145:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>L});var r=t(95155),i=t(40283),a=t(35695),n=t(12115),d=t(66695),l=t(30285),c=t(6874),o=t.n(c),x=t(28044),m=t(94063),u=t(66766),h=t(91840),p=t(87481),j=t(85127),g=t(62523),f=t(88539),v=t(31949),y=t(59966),N=t(45554),w=t(91721),b=t(40157);let A=(0,b.A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),k=(0,b.A)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);var C=t(8376),M=t(55365),D=t(26126),q=t(90498),R=t(54165),E=t(85057),z=t(46339);function F(e){let{reviewerUserId:s}=e,[t,i]=(0,n.useState)([]),[a,d]=(0,n.useState)(!0),[c,o]=(0,n.useState)(!1),[x,m]=(0,n.useState)(null),{toast:b}=(0,p.dj)(),[F,L]=(0,n.useState)(null),[S,I]=(0,n.useState)(!1),[U,B]=(0,n.useState)({expertDiagnosis:"",expertComments:""}),G=async()=>{d(!0),m(null);let e=await (0,h.gZ)();e.queries?i(e.queries):(m(e.error||"Failed to fetch pending expert queries."),b({variant:"destructive",title:"Error",description:e.error||"Could not load queries."})),d(!1)};(0,n.useEffect)(()=>{G()},[s]);let Z=e=>{var s;L(e),B({expertDiagnosis:(null==(s=e.diagnosis)?void 0:s.disease)||"",expertComments:""}),I(!0)},H=e=>{let{name:s,value:t}=e.target;B(e=>({...e,[s]:t}))},P=async()=>{if(!F||!F.id)return;if(!U.expertDiagnosis.trim())return void b({variant:"destructive",title:"Validation Error",description:"Expert diagnosis cannot be empty."});o(!0);let e=await (0,h.Om)(s,F.id,U.expertDiagnosis,U.expertComments);e.success?(b({title:"Review Submitted",description:e.message||"Expert diagnosis saved successfully."}),I(!1),G()):b({variant:"destructive",title:"Submission Failed",description:e.error||"Could not save expert review."}),o(!1)};return a?(0,r.jsxs)("div",{className:"flex items-center justify-center py-10",children:[(0,r.jsx)(z.G,{size:32}),(0,r.jsx)("p",{className:"ml-2 text-muted-foreground",children:"Loading pending queries..."})]}):x?(0,r.jsxs)(M.Fc,{variant:"destructive",children:[(0,r.jsx)(v.A,{className:"h-4 w-4"}),(0,r.jsx)(M.XL,{children:"Failed to load queries"}),(0,r.jsx)(M.TN,{children:x})]}):0===t.length?(0,r.jsxs)("div",{className:"text-center py-10",children:[(0,r.jsx)(y.A,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-xl font-semibold text-muted-foreground",children:"No pending expert queries."}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"All user requests for expert review have been addressed."})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(j.XI,{children:[(0,r.jsx)(j.r6,{children:"List of crop diagnoses awaiting expert review."}),(0,r.jsx)(j.A0,{children:(0,r.jsxs)(j.Hj,{children:[(0,r.jsx)(j.nd,{className:"w-[150px]",children:"Requested"}),(0,r.jsx)(j.nd,{children:"User ID"}),(0,r.jsx)(j.nd,{children:"Analysis"}),(0,r.jsx)(j.nd,{className:"text-center w-[100px]",children:"Image"}),(0,r.jsx)(j.nd,{className:"text-right w-[150px]",children:"Actions"})]})}),(0,r.jsx)(j.BF,{children:t.map(e=>(0,r.jsxs)(j.Hj,{children:[(0,r.jsx)(j.nA,{children:e.timestamp?(0,q.m)(new Date(e.timestamp),{addSuffix:!0}):"Unknown date"}),(0,r.jsx)(j.nA,{className:"truncate max-w-[150px] text-xs",children:e.userId}),(0,r.jsx)(j.nA,{children:e.diagnosis?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"font-medium flex items-center gap-2",children:[(0,r.jsx)(N.A,{className:"h-4 w-4 text-purple-500"}),e.diagnosis.disease]}),(0,r.jsxs)(D.E,{variant:"outline",className:"mt-1",children:["AI Conf: ",(100*e.diagnosis.confidence).toFixed(0),"%"]})]}):(0,r.jsxs)("div",{className:"font-medium text-muted-foreground italic flex items-center gap-2",children:[(0,r.jsx)(w.A,{className:"h-4 w-4 text-blue-500"}),"Direct Submission"]})}),(0,r.jsx)(j.nA,{className:"text-center",children:e.photoURL&&(0,r.jsxs)(R.lG,{children:[(0,r.jsx)(R.zM,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"ghost",size:"icon",children:(0,r.jsx)(A,{className:"h-5 w-5"})})}),(0,r.jsxs)(R.Cf,{className:"max-w-md",children:[(0,r.jsx)(R.c7,{children:(0,r.jsx)(R.L3,{children:"Crop Image"})}),(0,r.jsx)("div",{className:"relative aspect-video w-full mt-2 rounded-md overflow-hidden",children:(0,r.jsx)(u.default,{src:e.photoURL,alt:"Crop diagnosis image",layout:"fill",objectFit:"contain"})})]})]})}),(0,r.jsx)(j.nA,{className:"text-right",children:(0,r.jsxs)(l.$,{variant:"outline",size:"sm",onClick:()=>Z(e),children:[(0,r.jsx)(k,{className:"mr-2 h-4 w-4"})," Review"]})})]},e.id))})]}),F&&(0,r.jsx)(R.lG,{open:S,onOpenChange:I,children:(0,r.jsxs)(R.Cf,{className:"sm:max-w-lg",children:[(0,r.jsxs)(R.c7,{children:[(0,r.jsxs)(R.L3,{children:["Expert Review: ",F.diagnosis?'AI Diagnosed "'.concat(F.diagnosis.disease,'"'):"Direct User Query"]}),(0,r.jsx)(R.rr,{children:"Provide your expert assessment for this diagnosis query."})]}),(0,r.jsxs)("div",{className:"py-4 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium mb-1 text-sm",children:"Original User Description:"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground p-3 border rounded-md bg-secondary/30 whitespace-pre-wrap",children:F.description})]}),F.diagnosis&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium mb-1 text-sm",children:"AI Confidence:"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground p-2 border rounded-md bg-secondary/30",children:[(100*F.diagnosis.confidence).toFixed(0),"%"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium mb-1 text-sm",children:"AI Treatment Recommendations:"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground p-3 border rounded-md bg-secondary/30 whitespace-pre-wrap",children:F.diagnosis.treatmentRecommendations})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(E.J,{htmlFor:"expertDiagnosis",className:"text-sm font-medium",children:["Your Diagnosis ",(0,r.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,r.jsx)(g.p,{id:"expertDiagnosis",name:"expertDiagnosis",value:U.expertDiagnosis,onChange:H,disabled:c,placeholder:"e.g., Downey Mildew, Nutrient Deficiency"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(E.J,{htmlFor:"expertComments",className:"text-sm font-medium",children:"Comments & Recommendations"}),(0,r.jsx)(f.T,{id:"expertComments",name:"expertComments",rows:5,value:U.expertComments,onChange:H,disabled:c,placeholder:"Provide detailed comments, alternative treatments, or confirm AI findings..."})]})]}),(0,r.jsxs)(R.Es,{children:[(0,r.jsx)(l.$,{variant:"outline",onClick:()=>I(!1),disabled:c,children:"Cancel"}),(0,r.jsxs)(l.$,{onClick:P,disabled:c,children:[c?(0,r.jsx)(z.G,{size:16,className:"mr-2"}):(0,r.jsx)(C.A,{className:"mr-2 h-4 w-4"}),"Submit Review"]})]})]})})]})}function L(){let{userProfile:e,loading:s,currentUser:t}=(0,i.A)(),c=(0,a.useRouter)();return((0,n.useEffect)(()=>{s||e&&("admin"===e.role||"expert"===e.role)||c.push("/")},[e,s,c]),s)?(0,r.jsxs)("div",{className:"container mx-auto py-8 px-4 text-center flex flex-col items-center justify-center min-h-[calc(100vh-10rem)]",children:[(0,r.jsx)(z.G,{size:48,className:"mb-4"}),"Loading expert query management..."]}):e&&("admin"===e.role||"expert"===e.role)?(0,r.jsxs)("div",{className:"container mx-auto py-8 px-4",children:[(0,r.jsxs)("header",{className:"mb-8",children:[(0,r.jsxs)("h1",{className:"text-4xl font-headline flex items-center gap-3",children:[(0,r.jsx)(m.A,{className:"h-10 w-10 text-primary"})," Manage Expert Queries"]}),(0,r.jsx)("p",{className:"text-muted-foreground mt-2",children:"Review diagnosis queries flagged by users for expert assessment."})]}),(0,r.jsxs)(d.Zp,{className:"shadow-lg rounded-xl",children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsx)(d.ZB,{children:"Pending Reviews"}),(0,r.jsx)(d.BT,{children:"List of diagnosis entries awaiting expert review."})]}),(0,r.jsx)(d.Wu,{children:t&&(0,r.jsx)(F,{reviewerUserId:t.uid})})]})]}):(0,r.jsx)("div",{className:"container mx-auto py-12 px-4 flex flex-col items-center justify-center min-h-[calc(100vh-10rem)]",children:(0,r.jsxs)(d.Zp,{className:"w-full max-w-md text-center shadow-xl rounded-xl",children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsx)(x.A,{className:"h-16 w-16 text-destructive mx-auto mb-4"}),(0,r.jsx)(d.ZB,{className:"text-2xl",children:"Access Denied"})]}),(0,r.jsxs)(d.Wu,{children:[(0,r.jsx)(d.BT,{className:"text-lg",children:"You do not have permission to view this page. This area is restricted to administrators and experts."}),(0,r.jsx)(l.$,{asChild:!0,className:"mt-6",children:(0,r.jsx)(o(),{href:"/",children:"Go to Homepage"})})]})]})})}},77112:(e,s,t)=>{Promise.resolve().then(t.bind(t,60145))},91721:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},94063:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(40157).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,3644,668,3340,6874,6766,1263,3446,2528,4443,7124,623,8441,1684,7358],()=>s(77112)),_N_E=e.O()}]);