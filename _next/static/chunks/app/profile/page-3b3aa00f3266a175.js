(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6636],{17759:(e,t,r)=>{"use strict";r.d(t,{C5:()=>v,MJ:()=>h,Rr:()=>g,eI:()=>f,lR:()=>p,lV:()=>o,zB:()=>u});var s=r(95155),a=r(12115),l=r(99708),i=r(62177),n=r(59434),d=r(85057);let o=i.Op,c=a.createContext({}),u=e=>{let{...t}=e;return(0,s.jsx)(c.Provider,{value:{name:t.name},children:(0,s.jsx)(i.xI,{...t})})},m=()=>{let e=a.useContext(c),t=a.useContext(x),{getFieldState:r,formState:s}=(0,i.xW)(),l=r(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=t;return{id:n,name:e.name,formItemId:"".concat(n,"-form-item"),formDescriptionId:"".concat(n,"-form-item-description"),formMessageId:"".concat(n,"-form-item-message"),...l}},x=a.createContext({}),f=a.forwardRef((e,t)=>{let{className:r,...l}=e,i=a.useId();return(0,s.jsx)(x.Provider,{value:{id:i},children:(0,s.jsx)("div",{ref:t,className:(0,n.cn)("space-y-2",r),...l})})});f.displayName="FormItem";let p=a.forwardRef((e,t)=>{let{className:r,...a}=e,{error:l,formItemId:i}=m();return(0,s.jsx)(d.J,{ref:t,className:(0,n.cn)(l&&"text-destructive",r),htmlFor:i,...a})});p.displayName="FormLabel";let h=a.forwardRef((e,t)=>{let{...r}=e,{error:a,formItemId:i,formDescriptionId:n,formMessageId:d}=m();return(0,s.jsx)(l.DX,{ref:t,id:i,"aria-describedby":a?"".concat(n," ").concat(d):"".concat(n),"aria-invalid":!!a,...r})});h.displayName="FormControl";let g=a.forwardRef((e,t)=>{let{className:r,...a}=e,{formDescriptionId:l}=m();return(0,s.jsx)("p",{ref:t,id:l,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});g.displayName="FormDescription";let v=a.forwardRef((e,t)=>{var r;let{className:a,children:l,...i}=e,{error:d,formMessageId:o}=m(),c=d?String(null!=(r=null==d?void 0:d.message)?r:""):l;return c?(0,s.jsx)("p",{ref:t,id:o,className:(0,n.cn)("text-sm font-medium text-destructive",a),...i,children:c}):null});v.displayName="FormMessage"},26126:(e,t,r)=>{"use strict";r.d(t,{E:()=>n});var s=r(95155);r(12115);var a=r(74466),l=r(59434);let i=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)(i({variant:r}),t),...a})}},40283:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,AuthProvider:()=>u});var s=r(95155),a=r(12115),l=r(93004),i=r(80544),n=r(56631),d=r(46339);let o=(0,a.createContext)(void 0),c=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},u=e=>{let{children:t}=e,[r,c]=(0,a.useState)(null),[u,m]=(0,a.useState)(null),[x,f]=(0,a.useState)(!0);(0,a.useEffect)(()=>{console.log("AuthContext: Subscribing to auth state changes.");let e=(0,l.hg)(i.j2,async e=>{if(f(!0),c(e),e)try{console.log("AuthContext: User ".concat(e.uid," authenticated. Fetching profile..."));let t=await (0,n.VM)(e.uid);m(t),console.log("AuthContext: User profile fetched successfully:",t)}catch(t){console.error("AuthContext: Failed to fetch user profile for UID:",e.uid,"Error:",t),m(null)}finally{f(!1),console.log("AuthContext: Loading finished for authenticated user.")}else m(null),f(!1),console.log("AuthContext: No user authenticated or user logged out. Loading finished.")});return()=>{console.log("AuthContext: Unsubscribing from auth state changes."),e()}},[]);let p=async()=>{await i.j2.signOut()};return x?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background",children:[(0,s.jsx)(d.G,{size:64}),(0,s.jsx)("p",{className:"mt-4 text-lg text-muted-foreground",children:"Initializing Session..."})]}):(0,s.jsx)(o.Provider,{value:{currentUser:r,userProfile:u,loading:x,logout:p},children:t})}},46339:(e,t,r)=>{"use strict";r.d(t,{G:()=>i});var s=r(95155),a=r(53838),l=r(59434);let i=e=>{let{className:t,size:r=24}=e;return(0,s.jsx)(a.A,{size:r,className:(0,l.cn)("animate-grow-and-sway text-primary",t)})}},55365:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>d,TN:()=>c,XL:()=>o});var s=r(95155),a=r(12115),l=r(74466),i=r(59434);let n=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=a.forwardRef((e,t)=>{let{className:r,variant:a,...l}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(n({variant:a}),r),...l})});d.displayName="Alert";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",r),...a})});o.displayName="AlertTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",r),...a})});c.displayName="AlertDescription"},56631:(e,t,r)=>{"use strict";r.d(t,{G6:()=>d,VM:()=>c,WZ:()=>i,mu:()=>n});var s=r(93004),a=r(80544),l=r(35317);let i=async(e,t,r)=>{let l=await (0,s.eJ)(a.j2,e,t);return await (0,s.r7)(l.user,{displayName:r}),await o(l.user),l},n=async(e,t)=>(0,s.x9)(a.j2,e,t),d=async()=>{let e=new s.HF;try{let t=await (0,s.df)(a.j2,e);return t.user&&await o(t.user),t}catch(e){throw console.error("Error during Google sign-in:",e),e}},o=async e=>{if(!e)return;let t=(0,l.H9)(a.db,"users/".concat(e.uid)),r=await (0,l.x7)(t);if(r.exists()){let s=r.data(),a={};if(e.photoURL&&s.photoURL!==e.photoURL&&(a.photoURL=e.photoURL),e.displayName&&s.displayName!==e.displayName&&(a.displayName=e.displayName),Object.keys(a).length>0)try{await (0,l.mZ)(t,a)}catch(e){console.error("Error updating user profile on sign-in",e)}}else{let{email:r,displayName:s,uid:i,photoURL:n}=e,d=new Date().toISOString(),o=(0,l.rJ)(a.db,"users"),c=(0,l.P)(o,(0,l.AB)(1)),u=(await (0,l.GG)(c)).empty;try{await (0,l.BN)(t,{uid:i,email:r,displayName:s||(null==r?void 0:r.split("@")[0])||"User",photoURL:n||null,createdAt:d,role:u?"admin":"farmer",status:"active"})}catch(e){throw console.error("Error creating user document",e),e}}return t},c=async e=>{let t=(0,l.H9)(a.db,"users/".concat(e)),r=await (0,l.x7)(t);if(r.exists()){var s;let t=r.data(),a=(null==(s=t.createdAt)?void 0:s.toDate)?t.createdAt.toDate().toISOString():t.createdAt;return{...t,uid:e,createdAt:a}}return null}},62523:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var s=r(95155),a=r(12115),l=r(59434);let i=a.forwardRef((e,t)=>{let{className:r,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},66695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>i,aR:()=>n,wL:()=>u});var s=r(95155),a=r(12115),l=r(59434);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm transition-all duration-300 hover:shadow-xl hover:-translate-y-1",r),...a})});i.displayName="Card";let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...a})});n.displayName="CardHeader";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});d.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",r),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},80721:(e,t,r)=>{Promise.resolve().then(r.bind(r,90303))},85057:(e,t,r)=>{"use strict";r.d(t,{J:()=>o});var s=r(95155),a=r(12115),l=r(40968),i=r(74466),n=r(59434);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(l.b,{ref:t,className:(0,n.cn)(d(),r),...a})});o.displayName=l.b.displayName},87481:(e,t,r)=>{"use strict";r.d(t,{dj:()=>m});var s=r(12115);let a=0,l=new Map,i=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],o={toasts:[]};function c(e){o=n(o,e),d.forEach(e=>{e(o)})}function u(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function m(){let[e,t]=s.useState(o);return s.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},90303:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P});var s=r(95155),a=r(40283),l=r(35695),i=r(12115),n=r(62177),d=r(90221),o=r(55594),c=r(87481),u=r(30285),m=r(62523),x=r(66695),f=r(91721),p=r(31949),h=r(59119),g=r(17759),v=r(91840),j=r(55365),y=r(46339);let N=o.Ik({displayName:o.Yj().min(2,"Name must be at least 2 characters.")});function b(){let{currentUser:e,userProfile:t,loading:r}=(0,a.A)(),[l,o]=(0,i.useState)(!1),[b,w]=(0,i.useState)(null),{toast:A}=(0,c.dj)(),S=(0,n.mN)({resolver:(0,d.u)(N),defaultValues:{displayName:(null==t?void 0:t.displayName)||""},values:{displayName:(null==t?void 0:t.displayName)||""}}),R=async t=>{if(!e)return void w("You must be logged in to update your profile.");o(!0),w(null);let r=await (0,v.E8)(e.uid,t.displayName);r.success?A({title:"Profile Updated",description:"Your display name has been changed successfully."}):w(r.error||"Failed to update profile."),o(!1)};return r?(0,s.jsxs)(x.Zp,{className:"shadow-lg rounded-xl",children:[(0,s.jsx)(x.aR,{children:(0,s.jsx)(x.ZB,{children:"My Profile"})}),(0,s.jsx)(x.Wu,{children:(0,s.jsx)(y.G,{size:24})})]}):(0,s.jsxs)(x.Zp,{className:"shadow-lg rounded-xl",children:[(0,s.jsxs)(x.aR,{children:[(0,s.jsxs)(x.ZB,{className:"flex items-center gap-2 text-2xl",children:[(0,s.jsx)(f.A,{className:"h-6 w-6 text-primary"}),"My Profile"]}),(0,s.jsx)(x.BT,{children:"Update your personal information here."})]}),(0,s.jsx)(g.lV,{...S,children:(0,s.jsxs)("form",{onSubmit:S.handleSubmit(R),children:[(0,s.jsxs)(x.Wu,{className:"space-y-6",children:[(0,s.jsx)(g.zB,{control:S.control,name:"displayName",render:e=>{let{field:t}=e;return(0,s.jsxs)(g.eI,{children:[(0,s.jsx)(g.lR,{children:"Display Name"}),(0,s.jsx)(g.MJ,{children:(0,s.jsx)(m.p,{placeholder:"Your name",...t})}),(0,s.jsx)(g.C5,{})]})}}),(0,s.jsxs)(g.eI,{children:[(0,s.jsx)(g.lR,{children:"Email"}),(0,s.jsx)(m.p,{value:(null==t?void 0:t.email)||"",disabled:!0}),(0,s.jsx)(g.Rr,{children:"Email address cannot be changed."})]}),b&&(0,s.jsxs)(j.Fc,{variant:"destructive",children:[(0,s.jsx)(p.A,{className:"h-4 w-4"}),(0,s.jsx)(j.XL,{children:"Update Error"}),(0,s.jsx)(j.TN,{children:b})]})]}),(0,s.jsx)(x.wL,{children:(0,s.jsxs)(u.$,{type:"submit",disabled:l,children:[l?(0,s.jsx)(y.G,{size:16,className:"mr-2"}):(0,s.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})]})})]})}var w=r(87374),A=r(8376),S=r(85081),R=r(24371),E=r(59966),T=r(91462),C=r(67426),I=r(26126),F=r(66766);let O={placed:{label:"Placed",icon:w.A,color:"bg-blue-500"},approved:{label:"Approved",icon:A.A,color:"bg-yellow-500"},shipped:{label:"Shipped",icon:S.A,color:"bg-green-500"},delivered:{label:"Delivered",icon:A.A,color:"bg-primary"},cancelled:{label:"Cancelled",icon:R.A,color:"bg-destructive"}};function D(){let[e,t]=(0,i.useState)([]),[r,l]=(0,i.useState)(!0),[n,d]=(0,i.useState)(null),{currentUser:o}=(0,a.A)();return((0,i.useEffect)(()=>{(async()=>{if(!o)return;l(!0),d(null);let e=await (0,v.Nf)(o.uid);e.orders?t(e.orders):d(e.error||"Failed to fetch order history."),l(!1)})()},[o]),r)?(0,s.jsxs)("div",{className:"flex items-center justify-center py-10",children:[(0,s.jsx)(y.G,{size:32}),(0,s.jsx)("p",{className:"ml-2 text-muted-foreground",children:"Loading your order history..."})]}):n?(0,s.jsxs)(j.Fc,{variant:"destructive",children:[(0,s.jsx)(p.A,{className:"h-4 w-4"}),(0,s.jsx)(j.XL,{children:"Error Loading Orders"}),(0,s.jsx)(j.TN,{children:n})]}):0===e.length?(0,s.jsxs)("div",{className:"text-center py-10",children:[(0,s.jsx)(E.A,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-xl font-semibold text-muted-foreground",children:"No Orders Yet"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"You haven't placed any orders with us."})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("h2",{className:"text-2xl font-headline flex items-center gap-2",children:[(0,s.jsx)(T.A,{className:"h-6 w-6 text-primary"}),"My Orders"]}),(0,s.jsx)("div",{className:"space-y-4",children:e.map(e=>{var t,r;let a=(null==(t=O[e.status])?void 0:t.icon)||w.A;return(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start flex-wrap gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-semibold",children:["Order #",e.id.substring(0,8),"..."]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Placed on ",e.createdAt?(0,C.GP)(new Date(e.createdAt),"PPP"):"N/A"]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)(I.E,{variant:"secondary",className:"capitalize flex items-center gap-1.5",children:[(0,s.jsx)(a,{className:"h-3 w-3"}),(null==(r=O[e.status])?void 0:r.label)||e.status]}),(0,s.jsxs)("p",{className:"font-bold mt-1",children:["₹",e.totalAmount.toFixed(2)]})]})]}),(0,s.jsx)("div",{className:"space-y-3",children:e.items.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4 border-t pt-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(F.default,{src:e.imageUrl,alt:e.name,width:50,height:50,className:"rounded-md object-cover"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-sm line-clamp-1",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Qty: ",e.quantity," x ₹",e.price.toFixed(2)]})]})]}),(0,s.jsxs)("p",{className:"font-medium text-sm",children:["₹",(e.price*e.quantity).toFixed(2)]})]},e.id))})]},e.id)})})]})}function P(){let{currentUser:e,loading:t}=(0,a.A)(),r=(0,l.useRouter)();return((0,i.useEffect)(()=>{t||e||r.push("/login")},[e,t,r]),t||!e)?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[(0,s.jsx)(y.G,{size:48}),(0,s.jsx)("p",{className:"mt-4 text-muted-foreground",children:"Loading Profile..."})]}):(0,s.jsxs)("div",{className:"container mx-auto py-8 px-4",children:[(0,s.jsxs)("header",{className:"mb-12 text-center",children:[(0,s.jsx)("h1",{className:"text-4xl sm:text-5xl font-headline tracking-tight",children:"Your Account"}),(0,s.jsx)("p",{className:"mt-4 text-lg text-muted-foreground max-w-2xl mx-auto",children:"Manage your profile information and view your order history."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 items-start",children:[(0,s.jsx)("div",{className:"md:col-span-1",children:(0,s.jsx)(b,{})}),(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)(D,{})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,3644,668,3340,6766,5302,3446,2993,7124,8441,1684,7358],()=>t(80721)),_N_E=e.O()}]);