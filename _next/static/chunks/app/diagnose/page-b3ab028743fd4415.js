(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9387],{23954:(e,s,a)=>{Promise.resolve().then(a.bind(a,79806))},45554:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(40157).A)("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]])},59409:(e,s,a)=>{"use strict";a.d(s,{bq:()=>p,eb:()=>j,gC:()=>u,l6:()=>c,yv:()=>m});var t=a(95155),l=a(12115),r=a(31992),i=a(79556),n=a(77381),d=a(10518),o=a(59434);let c=r.bL;r.YJ;let m=r.WT,p=l.forwardRef((e,s)=>{let{className:a,children:l,...n}=e;return(0,t.jsxs)(r.l9,{ref:s,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[l,(0,t.jsx)(r.In,{asChild:!0,children:(0,t.jsx)(i.A,{className:"h-4 w-4 opacity-50"})})]})});p.displayName=r.l9.displayName;let x=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.PP,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,t.jsx)(n.A,{className:"h-4 w-4"})})});x.displayName=r.PP.displayName;let h=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.wn,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,t.jsx)(i.A,{className:"h-4 w-4"})})});h.displayName=r.wn.displayName;let u=l.forwardRef((e,s)=>{let{className:a,children:l,position:i="popper",...n}=e;return(0,t.jsx)(r.ZL,{children:(0,t.jsxs)(r.UC,{ref:s,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...n,children:[(0,t.jsx)(x,{}),(0,t.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,t.jsx)(h,{})]})})});u.displayName=r.UC.displayName,l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.JU,{ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...l})}).displayName=r.JU.displayName;let j=l.forwardRef((e,s)=>{let{className:a,children:l,...i}=e;return(0,t.jsxs)(r.q7,{ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(r.VF,{children:(0,t.jsx)(d.A,{className:"h-4 w-4"})})}),(0,t.jsx)(r.p4,{children:l})]})});j.displayName=r.q7.displayName,l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.wv,{ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...l})}).displayName=r.wv.displayName},76570:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(40157).A)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},79806:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>B});var t=a(95155),l=a(12115),r=a(66766),i=a(62177),n=a(90221),d=a(55594),o=a(30285),c=a(62523),m=a(88539),p=a(66695),x=a(55365),h=a(58127);let u=(0,a(40157).A)("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);var j=a(45554),f=a(31949),g=a(76570),y=a(91840),v=a(17759),N=a(40283),b=a(87481),w=a(41589),A=a(88240),k=a(84823),C=a(59409),R=a(46339);let z=d.Ik({image:d.Ie(e=>e instanceof FileList&&e.length>0,"Please upload an image of the crop."),description:d.Yj().min(10,"Please provide a description of at least 10 characters.").max(500,"Description must be 500 characters or less."),cropType:d.Yj().optional(),season:d.Yj().optional(),location:d.Yj().optional(),model:d.Yj().min(1,"Please select an AI model.")}),M=e=>new Promise((s,a)=>{let t=new FileReader;t.onload=()=>s(t.result),t.onerror=a,t.readAsDataURL(e)}),L=[{id:"googleai/gemini-1.5-flash-latest",name:"AgriBazaar Flash (Recommended)"},{id:"googleai/gemini-pro-vision",name:"AgriBazaar Pro Vision (Alternative)"},{id:"googleai/gemini-2.0-flash",name:"AgriBazaar Experimental Flash"}];function T(){let[e,s]=(0,l.useState)(null),[a,d]=(0,l.useState)(null),[T,B]=(0,l.useState)(!1),[P,S]=(0,l.useState)(!1),[q,V]=(0,l.useState)(null),[F,I]=(0,l.useState)(null),{currentUser:J}=(0,N.A)(),{toast:U}=(0,b.dj)(),{t:Z}=(0,w.o)(),D=(0,i.mN)({resolver:(0,n.u)(z),defaultValues:{description:"",cropType:"Unknown Crop",season:"Current Season",location:"Local Area",model:"googleai/gemini-1.5-flash-latest"}}),Y=e=>{var s;let a=null==(s=e.target.files)?void 0:s[0];if(a){let s=new FileReader;s.onloadend=()=>{I(s.result)},s.readAsDataURL(a),D.setValue("image",e.target.files)}else I(null)},_=async e=>{if(B(!0),V(null),s(null),d(null),!e.image||0===e.image.length){V("Image is required."),B(!1);return}J||U({variant:"destructive",title:Z("diagnose.toast.loginRecommendedTitle"),description:Z("diagnose.toast.loginRecommendedDescription")});try{let a=e.image[0],l=await M(a),r=await (0,y.xu)({photoDataUri:l,description:e.description,model:e.model});r.error?V(r.error):r.diagnosis?(s(r.diagnosis),U({title:Z("diagnose.toast.successTitle"),description:Z("diagnose.toast.successDescription",{disease:r.diagnosis.disease}),action:(0,t.jsx)(h.A,{className:"text-green-500"})}),r.diagnosis.disease&&!r.diagnosis.disease.toLowerCase().includes("unknown")&&D.setValue("cropType",r.diagnosis.disease.split(" ")[0]||e.cropType||"General Crop")):V("Unexpected response from diagnosis service.")}catch(e){V(e.message||"An unexpected error occurred. Please try again."),console.error(e)}finally{B(!1)}},E=async()=>{S(!0),V(null),d(null);let e=D.getValues("cropType")||"General Crop",s=D.getValues("season")||"Current Season",a=D.getValues("location")||"Local Area";try{let t=await (0,y.ap)({cropType:e,season:s,location:a});"error"in t?(V(t.error),U({variant:"destructive",title:"Failed",description:t.error})):(d({measures:t.measures}),U({title:Z("diagnose.toast.preventativeSuccessTitle"),description:Z("diagnose.toast.preventativeSuccessDescription")}))}catch(e){V("Failed to fetch preventative measures."),console.error(e),U({variant:"destructive",title:"Error",description:"Could not fetch preventative measures."})}finally{S(!1)}};return(0,t.jsx)(v.lV,{...D,children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-start",children:[(0,t.jsxs)(p.Zp,{className:"shadow-xl rounded-xl",children:[(0,t.jsxs)(p.aR,{children:[(0,t.jsxs)(p.ZB,{className:"flex items-center gap-2 text-2xl",children:[(0,t.jsx)(u,{className:"text-primary"})," ",Z("diagnose.form.title")]}),(0,t.jsx)(p.BT,{children:Z("diagnose.form.description")})]}),(0,t.jsxs)("form",{onSubmit:D.handleSubmit(_),className:"space-y-6",children:[(0,t.jsxs)(p.Wu,{className:"space-y-6",children:[(0,t.jsx)(v.zB,{control:D.control,name:"image",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.eI,{children:[(0,t.jsx)(v.lR,{children:Z("diagnose.form.imageLabel")}),(0,t.jsx)(v.MJ,{children:(0,t.jsx)(c.p,{type:"file",accept:"image/*",onChange:Y,className:"file:text-sm file:font-medium file:bg-primary/10 file:text-primary file:border-0 file:rounded-md file:px-3 file:py-1.5 hover:file:bg-primary/20",disabled:T})}),(0,t.jsx)(v.C5,{})]})}}),F&&(0,t.jsx)("div",{className:"mt-4 border rounded-lg overflow-hidden aspect-video relative w-full max-w-md mx-auto",children:(0,t.jsx)(r.default,{src:F,alt:"Crop preview",layout:"fill",objectFit:"contain","data-ai-hint":"leaf plant"})}),(0,t.jsx)(v.zB,{control:D.control,name:"description",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.eI,{children:[(0,t.jsx)(v.lR,{children:Z("diagnose.form.descriptionLabel")}),(0,t.jsx)(v.MJ,{children:(0,t.jsx)(m.T,{placeholder:Z("diagnose.form.descriptionPlaceholder"),...s,rows:4,disabled:T})}),(0,t.jsx)(v.C5,{})]})}}),(0,t.jsx)(v.zB,{control:D.control,name:"model",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.eI,{children:[(0,t.jsx)(v.lR,{children:Z("diagnose.form.modelLabel")}),(0,t.jsxs)(C.l6,{onValueChange:s.onChange,defaultValue:s.value,disabled:T,children:[(0,t.jsx)(v.MJ,{children:(0,t.jsx)(C.bq,{children:(0,t.jsx)(C.yv,{placeholder:Z("diagnose.form.modelPlaceholder")})})}),(0,t.jsx)(C.gC,{children:L.map(e=>(0,t.jsx)(C.eb,{value:e.id,children:e.name},e.id))})]}),(0,t.jsx)(v.Rr,{children:Z("diagnose.form.modelDescription")}),(0,t.jsx)(v.C5,{})]})}})]}),(0,t.jsx)(p.wL,{children:(0,t.jsxs)(o.$,{type:"submit",disabled:T,className:"w-full",children:[T?(0,t.jsx)(R.G,{size:16,className:"mr-2"}):(0,t.jsx)(j.A,{className:"mr-2 h-4 w-4"}),Z("diagnose.form.button")]})})]})]}),(0,t.jsxs)("div",{className:"space-y-8",children:[q&&(0,t.jsxs)(x.Fc,{variant:"destructive",children:[(0,t.jsx)(f.A,{className:"h-4 w-4"}),(0,t.jsx)(x.XL,{children:Z("common.error")}),(0,t.jsx)(x.TN,{children:q})]}),e&&(0,t.jsxs)(p.Zp,{className:"shadow-xl rounded-xl",children:[(0,t.jsx)(p.aR,{children:(0,t.jsxs)(p.ZB,{className:"flex items-center gap-2 text-2xl",children:[(0,t.jsx)(h.A,{className:"text-green-500"}),Z("diagnose.results.title")]})}),(0,t.jsxs)(p.Wu,{className:"space-y-4",children:[(0,t.jsxs)("p",{children:[(0,t.jsxs)("strong",{children:[Z("diagnose.results.disease"),":"]})," ",e.disease]}),(0,t.jsxs)("p",{children:[(0,t.jsxs)("strong",{children:[Z("diagnose.results.confidence"),":"]})," ",(100*e.confidence).toFixed(0),"%"]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("strong",{children:[Z("diagnose.results.recommendations"),":"]}),(0,t.jsx)("div",{className:"chat-prose mt-1",children:(0,t.jsx)(A.oz,{remarkPlugins:[k.A],children:e.treatmentRecommendations})})]})]})]}),e&&(0,t.jsxs)(p.Zp,{className:"shadow-xl rounded-xl",children:[(0,t.jsx)(p.aR,{children:(0,t.jsxs)(p.ZB,{className:"flex items-center gap-2 text-2xl",children:[(0,t.jsx)(g.A,{className:"text-blue-500"}),Z("diagnose.preventative.title")]})}),(0,t.jsxs)(p.Wu,{children:[P&&(0,t.jsxs)("div",{className:"flex items-center justify-center py-6",children:[(0,t.jsx)(R.G,{size:24}),(0,t.jsx)("p",{className:"ml-2 text-muted-foreground",children:Z("diagnose.preventative.loading")})]}),!a&&!P&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(p.BT,{children:Z("diagnose.preventative.subtitle")}),(0,t.jsx)(v.zB,{control:D.control,name:"cropType",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.eI,{children:[(0,t.jsx)(v.lR,{children:Z("diagnose.preventative.cropTypeLabel")}),(0,t.jsx)(v.MJ,{children:(0,t.jsx)(c.p,{...s})})]})}}),(0,t.jsx)(v.zB,{control:D.control,name:"season",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.eI,{children:[(0,t.jsx)(v.lR,{children:Z("diagnose.preventative.seasonLabel")}),(0,t.jsx)(v.MJ,{children:(0,t.jsx)(c.p,{...s})})]})}}),(0,t.jsx)(v.zB,{control:D.control,name:"location",render:e=>{let{field:s}=e;return(0,t.jsxs)(v.eI,{children:[(0,t.jsx)(v.lR,{children:Z("diagnose.preventative.locationLabel")}),(0,t.jsx)(v.MJ,{children:(0,t.jsx)(c.p,{...s})})]})}}),(0,t.jsxs)(o.$,{onClick:E,className:"w-full",children:[(0,t.jsx)(g.A,{className:"mr-2 h-4 w-4"})," ",Z("diagnose.preventative.button")]})]}),a&&(0,t.jsx)("div",{className:"space-y-4",children:a.measures.map((e,s)=>(0,t.jsxs)("div",{className:"p-3 border-b last:border-b-0",children:[(0,t.jsxs)("h4",{className:"font-headline text-lg flex items-center gap-2",children:[(0,t.jsx)(g.A,{className:"h-4 w-4 text-primary"}),e.title]}),(0,t.jsx)("div",{className:"chat-prose ml-6 mt-1",children:(0,t.jsx)(A.oz,{remarkPlugins:[k.A],children:e.content})})]},s))})]})]})]})]})})}function B(){let{t:e}=(0,w.o)();return(0,t.jsxs)("div",{className:"container mx-auto py-8 px-4",children:[(0,t.jsxs)("header",{className:"mb-12 text-center",children:[(0,t.jsx)("h1",{className:"text-4xl sm:text-5xl font-headline tracking-tight",children:e("diagnose.pageTitle")}),(0,t.jsx)("p",{className:"mt-4 text-lg text-muted-foreground max-w-2xl mx-auto",children:e("diagnose.pageSubtitle")})]}),(0,t.jsx)(T,{})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,3644,668,3340,6766,5302,1263,9037,1859,7446,7124,1589,4084,8441,1684,7358],()=>s(23954)),_N_E=e.O()}]);