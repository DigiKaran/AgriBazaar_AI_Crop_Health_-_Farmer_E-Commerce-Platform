"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7124],{30285:(e,r,t)=>{t.d(r,{$:()=>d,r:()=>n});var a=t(95155),o=t(12115),s=t(99708),c=t(74466),i=t(59434);let n=(0,c.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=o.forwardRef((e,r)=>{let{className:t,variant:o,size:c,asChild:d=!1,...l}=e,u=d?s.DX:"button";return(0,a.jsx)(u,{className:(0,i.cn)(n({variant:o,size:c,className:t})),ref:r,...l})});d.displayName="Button"},59434:(e,r,t)=>{t.d(r,{cn:()=>s});var a=t(52596),o=t(39688);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,o.QP)((0,a.$)(r))}},80544:(e,r,t)=>{let a,o,s,c;t.d(r,{j2:()=>o,db:()=>s,IG:()=>c});var i=t(23915),n=t(93004),d=t(35317),l=t(90858);a=0===(0,i.Dk)().length?(0,i.Wp)({apiKey:"AIzaSyBTQTCwDlpZr3mnPRi-PYNrfTdLnwW8ZYU",authDomain:"agricheck-vllr7.firebaseapp.com",projectId:"agricheck-vllr7",storageBucket:"agricheck-vllr7.appspot.com",messagingSenderId:"591803120265",appId:"1:591803120265:web:fba3074d59f86d841b2458",measurementId:"G-XXXXXXXXXX"}):(0,i.Dk)()[0],o=(0,n.xI)(a),s=(0,d.aU)(a),c=(0,l.c7)(a);let u=async()=>{let e=(0,d.wP)(s),r=!1;for(let t of["orders","diagnosis_history","chat_messages","users","products","product_categories"]){let a=(0,d.H9)(s,t,"_placeholder_");try{(await (0,d.x7)(a)).exists()||(e.set(a,{info:"This is a placeholder for the '".concat(t,"' collection."),createdAt:new Date}),r=!0)}catch(e){console.error("Error checking/creating placeholder for ".concat(t,":"),e)}}if(r)try{await e.commit(),console.log("Firestore placeholder documents created.")}catch(e){console.error("Error committing placeholder batch:",e)}},g=async()=>{let e=(0,d.H9)(s,"products","_seed_check_");try{if((await (0,d.x7)(e)).exists())return void console.log("Sample data already exists. Skipping database seeding.");console.log("Seeding database with sample data...");let r=(0,d.wP)(s);[{name:"Fertilizers"},{name:"Pesticides"},{name:"Seeds"},{name:"Herbicides"},{name:"Equipment"}].forEach(e=>{let t=(0,d.H9)((0,d.rJ)(s,"product_categories"));r.set(t,e)}),[{id:"TRACTOR-001",name:"High-Efficiency Tractor",category:"Equipment",price:75e4,stock:5,imageUrl:"https://placehold.co/600x400.png",description:"A powerful and fuel-efficient tractor for all your farming needs. Comes with a 5-year warranty.",dataAiHint:"tractor farming"},{id:"UREA-F-01",name:"Urea Fertilizer (46-0-0)",category:"Fertilizers",price:599.5,stock:200,imageUrl:"https://placehold.co/600x400.png",description:"High-quality nitrogen fertilizer to boost plant growth. Ideal for a variety of crops.",dataAiHint:"fertilizer bag"},{id:"NEEM-P-01",name:"Organic Neem Oil Pesticide",category:"Pesticides",price:850,stock:150,imageUrl:"https://placehold.co/600x400.png",description:"Eco-friendly pest control solution derived from neem seeds. Effective against a wide range of insects.",dataAiHint:"pesticide bottle"},{id:"WHEAT-S-01",name:"Certified Wheat Seeds",category:"Seeds",price:1200,stock:500,imageUrl:"https://placehold.co/600x400.png",description:"High-yield, disease-resistant wheat seeds suitable for Indian climates. Pack of 10kg.",dataAiHint:"wheat seeds"},{id:"GLYPH-H-01",name:"Glyphosate Herbicide",category:"Herbicides",price:750,stock:100,imageUrl:"https://placehold.co/600x400.png",description:"A broad-spectrum systemic herbicide used to kill weeds, especially annual broadleaf weeds and grasses.",dataAiHint:"herbicide bottle"},{id:"PUMP-E-01",name:"Manual Sprayer Pump (16L)",category:"Equipment",price:2500,stock:50,imageUrl:"https://placehold.co/600x400.png",description:"Durable and easy-to-use manual sprayer for applying fertilizers, pesticides, and herbicides.",dataAiHint:"sprayer pump"},{id:"DAP-F-02",name:"DAP Fertilizer (18-46-0)",category:"Fertilizers",price:1350,stock:180,imageUrl:"https://placehold.co/600x400.png",description:"Di-ammonium Phosphate is a widely used phosphorus fertilizer, providing essential nutrients.",dataAiHint:"fertilizer sack"},{id:"RICE-S-02",name:"Hybrid Paddy Rice Seeds",category:"Seeds",price:950,stock:400,imageUrl:"https://placehold.co/600x400.png",description:"High-yielding hybrid rice seeds known for their resistance to common pests and diseases. Pack of 5kg.",dataAiHint:"rice seeds"}].forEach(e=>{let t=(0,d.H9)(s,"products",e.id),{id:a,...o}=e;r.set(t,o)}),r.set(e,{seeded:!0,timestamp:new Date}),await r.commit(),console.log("Database seeded successfully.")}catch(e){console.error("Error seeding database: ",e)}};(async()=>{try{await (0,d.ol)(s,{cacheSizeBytes:d.H6}),console.log("Firestore offline persistence enabled.")}catch(e){"failed-precondition"===e.code||("unimplemented"===e.code?console.warn("Firestore offline persistence not supported in this browser."):console.error("Error enabling Firestore offline persistence:",e))}await u(),await g()})()},91840:(e,r,t)=>{t.d(r,{ho:()=>L,B2:()=>j,FZ:()=>W,Xc:()=>Z,xu:()=>S,cx:()=>J,gZ:()=>B,ap:()=>U,dZ:()=>T,gC:()=>z,uI:()=>R,np:()=>Y,Wg:()=>X,DZ:()=>N,Nf:()=>O,qd:()=>K,ro:()=>G,sA:()=>I,Om:()=>M,IJ:()=>$,nv:()=>Q,RL:()=>q,E8:()=>C});var a=t(35317),o=t(80544);let s=e=>{if(!e)return e;let r={...e};for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e)){let t=r[e];t&&"function"==typeof t.toDate?r[e]=t.toDate().toISOString():Array.isArray(t)?r[e]=t.map(e=>s(e)):"object"!=typeof t||null===t||Array.isArray(t)||(r[e]=s(t))}return r},c="diagnosis_history",i=async e=>{try{let r={...e,timestamp:(0,a.O5)()};return(await (0,a.gS)((0,a.rJ)(o.db,c),r)).id}catch(e){throw console.error("Error saving diagnosis entry: ",e),Error("Failed to save diagnosis entry to database.")}},n=async(e,r)=>{let t=(0,a.H9)(o.db,c,e);try{"expert_reviewed"!==r.status||r.expertReviewedAt||(r.expertReviewedAt=(0,a.O5)()),await (0,a.mZ)(t,r)}catch(e){throw console.error("Error updating diagnosis history entry: ",e),Error("Failed to update diagnosis history.")}},d=async()=>{try{let e=(0,a.P)((0,a.rJ)(o.db,c),(0,a._M)("status","==","pending_expert")),r=await (0,a.GG)(e),t=[];return r.forEach(e=>{t.push({id:e.id,...s(e.data())})}),t}catch(r){console.error("Error fetching pending expert queries from DB: ",r);let e="Failed to fetch pending expert queries.";throw r.message&&(e+=" Firebase: ".concat(r.message)),r.code&&(e+=" (Code: ".concat(r.code,")")),Error(e)}},l=async()=>{try{let e=(0,a.P)((0,a.rJ)(o.db,c),(0,a.My)("timestamp","desc")),r=await (0,a.GG)(e),t=[];return r.forEach(e=>{t.push({id:e.id,...s(e.data())})}),t}catch(e){throw console.error("Error fetching all diagnosis entries from DB: ",e),Error("Failed to fetch all diagnosis entries. ".concat(e.message||"").trim())}},u=async e=>{try{return(await (0,a.gS)((0,a.rJ)(o.db,"chat_messages"),{...e,timestamp:(0,a.O5)()})).id}catch(e){throw console.error("Error saving chat message: ",e),Error("Failed to save chat message.")}},g="users",p=async()=>{try{let e=(0,a.P)((0,a.rJ)(o.db,g),(0,a.My)("createdAt","desc")),r=await (0,a.GG)(e),t=[];return r.forEach(e=>{t.push({uid:e.id,...s(e.data())})}),t}catch(r){console.error("Error fetching all users from DB: ",r);let e="Failed to fetch users.";throw r.message&&(e+=" Details: ".concat(r.message)),Error(e)}},h=async(e,r)=>{try{let t=(0,a.H9)(o.db,g,e),s=Object.fromEntries(Object.entries(r).filter(e=>{let[r,t]=e;return void 0!==t}));if(0===Object.keys(s).length)return;await (0,a.mZ)(t,s)}catch(r){console.error("Error updating user by admin: ",r);let e="Failed to update user profile.";throw r.message&&(e+=" Firebase: ".concat(r.message)),r.code&&(e+=" (Code: ".concat(r.code,")")),Error(e)}},m=async(e,r)=>{try{let t=(0,a.H9)(o.db,g,e);await (0,a.mZ)(t,r)}catch(e){throw console.error("Error updating user document in DB: ",e),Error("Failed to update user data. ".concat(e.message||"").trim())}},y="products",f=async()=>{try{let e=(0,a.P)((0,a.rJ)(o.db,y),(0,a.My)("name","asc")),r=await (0,a.GG)(e),t=[];return r.forEach(e=>{"_placeholder_"!==e.id&&t.push({id:e.id,...e.data()})}),t}catch(e){throw console.error("Error fetching products from DB: ",e),Error("Failed to fetch products. ".concat(e.message||"").trim())}},w=async e=>{try{return(await (0,a.gS)((0,a.rJ)(o.db,y),e)).id}catch(e){throw Error("Failed to add product. ".concat(e.message))}},b=async(e,r)=>{try{let t=(0,a.H9)(o.db,y,e);await (0,a.mZ)(t,r)}catch(e){throw Error("Failed to update product. ".concat(e.message))}},E=async e=>{try{await (0,a.kd)((0,a.H9)(o.db,y,e))}catch(e){throw Error("Failed to delete product. ".concat(e.message))}},v="product_categories",F=async()=>{try{let e=(0,a.P)((0,a.rJ)(o.db,v),(0,a.My)("name","asc")),r=await (0,a.GG)(e),t=[];return r.forEach(e=>{"_placeholder_"!==e.id&&t.push({id:e.id,...e.data()})}),t}catch(e){throw console.error("Error fetching product categories: ",e),Error("Failed to fetch product categories. ".concat(e.message||"").trim())}},x=async e=>{try{return(await (0,a.gS)((0,a.rJ)(o.db,v),{name:e})).id}catch(e){throw console.error("Error adding product category: ",e),Error("Failed to add product category. ".concat(e.message||"").trim())}},A=async e=>{try{await (0,a.kd)((0,a.H9)(o.db,v,e))}catch(e){throw console.error("Error deleting product category: ",e),Error("Failed to delete product category. ".concat(e.message||"").trim())}},k="orders",H=async e=>{try{return(await (0,a.gS)((0,a.rJ)(o.db,k),{...e,createdAt:(0,a.O5)()})).id}catch(e){throw console.error("Error saving order: ",e),Error("Failed to save order. ".concat(e.message||"").trim())}},P=async e=>{try{let r=(0,a.P)((0,a.rJ)(o.db,k),(0,a._M)("userId","==",e)),t=await (0,a.GG)(r),c=[];return t.forEach(e=>{c.push({id:e.id,...s(e.data())})}),c}catch(e){throw Error("Failed to fetch user orders. ".concat(e.message))}},_=async()=>{try{let e=(0,a.P)((0,a.rJ)(o.db,k),(0,a._M)("status","==","placed"),(0,a.My)("createdAt","asc")),r=await (0,a.GG)(e),t=[];return r.forEach(e=>{t.push({id:e.id,...s(e.data())})}),t}catch(e){throw Error("Failed to fetch pending orders. ".concat(e.message))}},D=async(e,r)=>{try{let t=(0,a.H9)(o.db,k,e);await (0,a.mZ)(t,{status:r})}catch(e){throw Error("Failed to update order status. ".concat(e.message))}};async function S(e){try{if(aiResult.diagnosis)return{diagnosis:aiResult.diagnosis};return{error:"Unknown error from AI diagnosis. The model may have returned an unexpected format."}}catch(e){return console.error("Error in diagnoseCropAction:",e),{error:"Failed to diagnose crop. ".concat(e.message||"").trim()}}}async function I(e,r){if(!r)return{success:!1,error:"User is not authenticated."};try{let t={userId:r,photoURL:e.photoURL,description:e.description,diagnosis:null,expertReviewRequested:!0,status:"pending_expert"},a=await i(t);return{success:!0,historyId:a}}catch(e){return console.error("Error in submitDirectExpertQueryAction:",e),{success:!1,error:"Failed to submit query. ".concat(e.message||"").trim()}}}async function U(e){try{return result}catch(e){return console.error("Error in generatePreventativeMeasuresAction:",e),{error:"Failed to generate preventative measures. ".concat(e.message||"").trim()}}}async function R(e){try{return result}catch(r){console.error("Error in getLocalizedFarmingTipsAction:",r);let e="object"==typeof r&&null!==r&&"message"in r?r.message:"An unknown error occurred";return{error:"Failed to generate farming tips: ".concat(e,". Please try again.")}}}async function G(e){if(!e.userId)return{};try{return{messageId:await u(e)}}catch(e){return console.error("Error in saveChatMessageAction:",e),{error:"Failed to save chat message. ".concat(e.message||"").trim()}}}async function z(e){try{return result}catch(e){return console.error("Error in getAgriBotResponseAction:",e),{error:"Failed to get response from AgriBot. ".concat(e.message||"").trim()}}}async function C(e,r){try{return await m(e,{displayName:r}),{success:!0}}catch(e){return{success:!1,error:"Failed to update profile. ".concat(e.message||"").trim()}}}async function O(e){try{return{orders:await P(e)}}catch(e){return{error:"Failed to fetch order history. ".concat(e.message||"").trim()}}}async function J(e){try{return{users:await p()}}catch(r){console.error("Error in fetchAllUsersAction:",r);let e="Failed to fetch users.";return r&&"object"==typeof r&&"message"in r&&(e+=" Details: ".concat(r.message)),{error:e.trim()}}}async function q(e,r,t){try{return await h(e,r),{success:!0}}catch(r){console.error("Error updating user profile action:",r);let e=r.message||"An unknown error occurred.";return{error:"Failed to update user profile. ".concat(e).trim()}}}async function B(){try{return{queries:await d()}}catch(r){console.error("Error in fetchPendingExpertQueriesAction:",r);let e=r.message||"An unknown error occurred.";return{error:"Failed to fetch pending expert queries. ".concat(e).trim()}}}async function M(e,r,t,a){if(!e)return{success:!1,error:"An authenticated user is required."};if(!r)return{error:"Query ID is required.",success:!1};if(!t.trim())return{error:"Expert diagnosis cannot be empty.",success:!1};try{return await n(r,{expertDiagnosis:t,expertComments:a.trim()||null,expertReviewedBy:e,status:"expert_reviewed",expertReviewedAt:new Date().toISOString()}),{success:!0,message:"Expert review submitted successfully."}}catch(e){return console.error("Error submitting expert diagnosis:",e),{error:"Failed to submit expert review. ".concat(e.message||"").trim(),success:!1}}}async function X(e){try{return{categories:await F()}}catch(e){return{error:"Failed to fetch product categories. ".concat(e.message||"").trim()}}}async function j(e,r){if(!r||r.trim().length<2)return{error:"Category name must be at least 2 characters long."};try{return{category:{id:await x(r),name:r}}}catch(e){return{error:"Failed to add product category. ".concat(e.message||"").trim()}}}async function Z(e,r){try{return await A(r),{success:!0}}catch(e){return{error:"Failed to delete product category. ".concat(e.message||"").trim()}}}async function T(e){try{let[e,r,t]=await Promise.all([p(),l(),F()]),a=e.reduce((e,r)=>(e[r.role]=(e[r.role]||0)+1,e),{farmer:0,expert:0,admin:0}),o=r.filter(e=>"pending_expert"===e.status&&e.timestamp);return{stats:{totalUsers:e.length,usersByRole:a,totalDiagnoses:r.length,pendingQueries:o.length,totalCategories:t.length}}}catch(e){return console.error("Error in getAdminDashboardStatsAction:",e),{error:"Failed to fetch dashboard stats. ".concat(e.message||"").trim()}}}async function N(e){try{return{products:await f()}}catch(e){return{error:"Failed to fetch products. ".concat(e.message||"").trim()}}}async function L(e,r){try{let e=await w(r);return{product:{...r,id:e}}}catch(e){return{error:"Failed to add product. ".concat(e.message||"").trim()}}}async function Q(e,r){try{return await b(r.id,r),{product:r}}catch(e){return{error:"Failed to update product. ".concat(e.message||"").trim()}}}async function W(e,r){try{return await E(r),{success:!0}}catch(e){return{error:"Failed to delete product. ".concat(e.message||"").trim()}}}async function Y(e){try{return{orders:await _()}}catch(e){return{error:"Failed to fetch pending orders. ".concat(e.message||"").trim()}}}async function $(e,r,t){try{return await D(r,t),{success:!0}}catch(e){return{error:"Failed to update order status. ".concat(e.message||"").trim()}}}async function K(e){if(!e.userId)return{success:!1,error:"User is not authenticated."};if(!e.items||0===e.items.length)return{success:!1,error:"Cannot place an order with an empty cart."};try{let r=await H({...e,status:"placed"});return{success:!0,orderId:r}}catch(e){return console.error("Error in placeOrderAction:",e),{success:!1,error:"Failed to place order. ".concat(e.message||"").trim()}}}}}]);